:root {
  --bg-1: #0c172a;
  --bg-2: #071124;
  --panel: #111f3a;
  --panel-soft: #152747;
  --text: #e7edf9;
  --muted: #9fb1d1;
  --ok: #1db954;
  --danger: #ef4444;
  --accent: #0f766e;
  --border: #31486f;
  --shadow: 0 10px 28px rgba(0, 0, 0, 0.35);
  --radius: 18px;
  --parallax-x: 0;
  --parallax-y: 0;
}

* {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  min-height: 100%;
  font-family: 'Avenir Next', 'Montserrat', 'Segoe UI', sans-serif;
  background:
    radial-gradient(circle at 18% 12%, #1b315e 0%, transparent 34%),
    radial-gradient(circle at 82% 0%, #14417f 0%, transparent 35%),
    linear-gradient(145deg, var(--bg-1), var(--bg-2));
  color: var(--text);
  position: relative;
}

body::before {
  content: '';
  position: fixed;
  inset: -12%;
  pointer-events: none;
  z-index: -1;
  background:
    radial-gradient(circle at 22% 32%, #45d0ff1c 0%, transparent 42%),
    radial-gradient(circle at 80% 70%, #7cffb91f 0%, transparent 44%);
  transform: translate(
    calc(var(--parallax-x) * 16px),
    calc(var(--parallax-y) * 16px)
  );
  transition: transform 0.25s ease-out;
}

button,
input,
select {
  font: inherit;
}

button {
  transition:
    transform 0.12s ease,
    filter 0.12s ease,
    box-shadow 0.16s ease,
    opacity 0.16s ease;
}

button:active,
button.is-pressing {
  transform: translateY(1px) scale(0.98);
  filter: brightness(0.95);
}

.app-shell {
  width: min(960px, 100%);
  margin: 0 auto;
  padding: 16px;
}

.app-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 14px;
}

.header-actions {
  display: flex;
  gap: 8px;
}

.app-header h1 {
  margin: 0;
  font-size: clamp(1.35rem, 3.8vw, 1.95rem);
}

.app-header p {
  margin: 4px 0 0;
  color: var(--muted);
  font-size: 0.92rem;
}

.icon-btn {
  width: 44px;
  height: 44px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: linear-gradient(180deg, #24385f, #1a2947);
  color: var(--text);
}

.trophy-btn {
  border-color: #b98925;
  background: linear-gradient(180deg, #f5d56c, #b9831c);
  color: #2b1d05;
  box-shadow: 0 0 18px #f9c74a42;
}

.app-main {
  display: grid;
  gap: 12px;
}

.player-selector {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 8px;
}

.player-chip {
  border: 2px solid color-mix(in oklab, var(--chip-color), #ffffff 20%);
  background: color-mix(in oklab, var(--chip-color), #0b1324 72%);
  border-radius: 14px;
  color: #fff;
  padding: 12px;
  font-weight: 700;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  position: relative;
  transition:
    transform 0.14s ease,
    box-shadow 0.18s ease,
    filter 0.14s ease;
}

.player-chip-avatar {
  font-size: 1rem;
  line-height: 1;
}

.player-chip-crown {
  position: absolute;
  top: -8px;
  right: -2px;
  font-size: 1rem;
  filter: drop-shadow(0 0 8px #ffd55e);
  animation: chipCrownGlow 1.4s ease-in-out infinite;
  pointer-events: none;
}

.player-chip.active {
  transform: translateY(-1px);
  box-shadow: 0 0 0 2px #fff2, var(--shadow);
}

.active-player-card {
  background: linear-gradient(165deg, #1a3158, #101f3b);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 18px;
  position: relative;
  overflow: hidden;
  transition:
    border-color 0.24s ease,
    box-shadow 0.24s ease,
    transform 0.24s ease;
}

.active-player-card::after {
  content: '';
  position: absolute;
  inset: -35%;
  pointer-events: none;
  background: radial-gradient(circle, color-mix(in oklab, var(--active-color, #0f766e), #ffffff 12%) 0%, transparent 62%);
  opacity: 0.22;
  filter: blur(10px);
  animation: activeAuraPulse 2.8s ease-in-out infinite;
}

.active-player-card h2 {
  margin: 0;
  font-size: clamp(1.25rem, 4.8vw, 2rem);
}

.active-player-card p {
  margin: 6px 0;
  color: var(--muted);
}

.active-player-card strong {
  display: block;
  font-size: clamp(1.8rem, 6vw, 2.8rem);
  line-height: 1;
}

.player-switch {
  animation: playerSwitch 240ms ease;
}

@keyframes playerSwitch {
  0% {
    opacity: 0.55;
    transform: translateY(4px) scale(0.985);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes chipCrownGlow {
  0%,
  100% {
    transform: translateY(0) scale(1);
    filter: drop-shadow(0 0 8px #ffd55e);
  }
  50% {
    transform: translateY(-1px) scale(1.08);
    filter: drop-shadow(0 0 12px #ffe993);
  }
}

.balance-pulse {
  animation: pulse 320ms ease;
}

.balance-up {
  color: #69f3a6;
}

.balance-down {
  color: #ff8f97;
}

.insufficient-shake {
  animation: insufficientShake 0.36s ease;
}

@keyframes pulse {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.07);
  }
  100% {
    transform: scale(1);
  }
}

.actions-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.action-btn {
  min-height: 62px;
  border: 0;
  border-radius: 14px;
  color: #fff;
  font-size: clamp(1rem, 3.5vw, 1.15rem);
  font-weight: 800;
  letter-spacing: 0.02em;
}

.action-btn.receive {
  background: linear-gradient(180deg, #22c55e, #17843e);
}

.action-btn.pay {
  background: linear-gradient(180deg, #ef4444, #ab1f2f);
}

.action-btn:disabled {
  opacity: 0.5;
}

.dice-panel {
  background: linear-gradient(160deg, #172b4d, #111f3a);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 14px;
  box-shadow: var(--shadow);
  position: relative;
  overflow: hidden;
}

.dice-panel.jackpot::after {
  content: '';
  position: absolute;
  inset: -30%;
  background: radial-gradient(circle, #ffe1883d 0%, transparent 60%);
  animation: jackpotPulse 0.55s ease 2;
  pointer-events: none;
}

.dice-panel.ultra-jackpot::before {
  content: '';
  position: absolute;
  inset: -30%;
  pointer-events: none;
  background: conic-gradient(from 0deg, #ffd97730, #ff8f5e2d, #ffe87d38, #ffd97730);
  animation: ultraJackpotSpin 1.2s linear infinite;
}

.dice-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.dice-head h3 {
  margin: 0;
}

.dice-stage {
  margin-top: 12px;
  padding: 8px;
  display: flex;
  justify-content: center;
  gap: 12px;
  perspective: 700px;
}

.die {
  width: 72px;
  height: 72px;
  border-radius: 16px;
  border: 1px solid #6f8eb7;
  background:
    radial-gradient(circle at 28% 22%, #ffffff 0%, #e7edf9 38%, #cfd9eb 100%);
  box-shadow:
    inset 0 -8px 14px #9caecb88,
    0 8px 16px #0411278c;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  padding: 9px;
  transform-style: preserve-3d;
}

.pip {
  width: 12px;
  height: 12px;
  border-radius: 999px;
  margin: auto;
  background: #0f1b33;
  opacity: 0;
  transform: scale(0.7);
  transition: opacity 0.12s ease, transform 0.12s ease;
}

.die[data-value='1'] .pip:nth-child(5),
.die[data-value='2'] .pip:nth-child(1),
.die[data-value='2'] .pip:nth-child(9),
.die[data-value='3'] .pip:nth-child(1),
.die[data-value='3'] .pip:nth-child(5),
.die[data-value='3'] .pip:nth-child(9),
.die[data-value='4'] .pip:nth-child(1),
.die[data-value='4'] .pip:nth-child(3),
.die[data-value='4'] .pip:nth-child(7),
.die[data-value='4'] .pip:nth-child(9),
.die[data-value='5'] .pip:nth-child(1),
.die[data-value='5'] .pip:nth-child(3),
.die[data-value='5'] .pip:nth-child(5),
.die[data-value='5'] .pip:nth-child(7),
.die[data-value='5'] .pip:nth-child(9),
.die[data-value='6'] .pip:nth-child(1),
.die[data-value='6'] .pip:nth-child(3),
.die[data-value='6'] .pip:nth-child(4),
.die[data-value='6'] .pip:nth-child(6),
.die[data-value='6'] .pip:nth-child(7),
.die[data-value='6'] .pip:nth-child(9) {
  opacity: 1;
  transform: scale(1);
}

.die.rolling {
  animation: dieRoll 0.22s linear infinite;
}

.dice-stage.rolling {
  animation: stageShake 0.25s linear infinite;
}

.dice-stage.impact .die {
  animation: dieImpact 0.24s ease;
}

.die.result-pop {
  animation: diePop 0.32s ease;
}

.dice-result {
  margin: 10px 0 0;
  text-align: center;
  color: #dbe7ff;
  font-weight: 800;
  letter-spacing: 0.01em;
}

.dice-result.jackpot {
  color: #ffe89d;
  text-shadow:
    0 0 8px #ffd86b,
    0 0 14px #ffd86b70;
  animation: jackpotText 0.45s ease 2;
}

@keyframes dieRoll {
  0% {
    transform: translateY(-2px) rotateX(0deg) rotateY(0deg);
  }
  50% {
    transform: translateY(3px) rotateX(180deg) rotateY(180deg);
  }
  100% {
    transform: translateY(-2px) rotateX(360deg) rotateY(360deg);
  }
}

@keyframes stageShake {
  0% {
    transform: translateX(-2px);
  }
  50% {
    transform: translateX(2px);
  }
  100% {
    transform: translateX(-2px);
  }
}

@keyframes dieImpact {
  0% {
    transform: translateY(-6px) scale(1.02);
  }
  100% {
    transform: translateY(0) scale(1);
  }
}

@keyframes diePop {
  0% {
    transform: scale(0.9);
  }
  60% {
    transform: scale(1.08);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes transferShock {
  0% {
    opacity: 0;
    transform: scale(0.75);
  }
  35% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(1.18);
  }
}

@keyframes transferSourcePulse {
  0% {
    box-shadow: 0 0 0 0 #8dd4ff00;
  }
  50% {
    box-shadow: 0 0 0 7px #8dd4ff33;
  }
  100% {
    box-shadow: 0 0 0 0 #8dd4ff00;
  }
}

@keyframes transferTargetPulse {
  0% {
    box-shadow: 0 0 0 0 #8effb500;
  }
  40% {
    box-shadow: 0 0 0 10px #8effb533;
  }
  100% {
    box-shadow: 0 0 0 0 #8effb500;
  }
}

@keyframes transferCriticalPulse {
  0% {
    opacity: 0;
    transform: scale(0.85);
  }
  45% {
    opacity: 1;
    transform: scale(1.05);
  }
  100% {
    opacity: 0;
    transform: scale(1.2);
  }
}

@keyframes transferSwapFlip {
  0% {
    transform: rotateX(0deg);
  }
  50% {
    transform: rotateX(90deg);
  }
  100% {
    transform: rotateX(0deg);
  }
}

@keyframes activeAuraPulse {
  0%,
  100% {
    opacity: 0.16;
    transform: scale(1);
  }
  50% {
    opacity: 0.3;
    transform: scale(1.04);
  }
}

@keyframes insufficientShake {
  0%,
  100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-5px);
  }
  50% {
    transform: translateX(5px);
  }
  75% {
    transform: translateX(-4px);
  }
}

@keyframes historyEnterReceive {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes historyEnterPay {
  from {
    opacity: 0;
    transform: translateX(10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes historyEnterTransfer {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes jackpotPulse {
  0% {
    opacity: 0;
    transform: scale(0.8);
  }
  40% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(1.15);
  }
}

@keyframes jackpotText {
  0% {
    transform: scale(1);
  }
  55% {
    transform: scale(1.08);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes ultraJackpotSpin {
  from {
    transform: rotate(0deg);
    opacity: 0.35;
  }
  to {
    transform: rotate(360deg);
    opacity: 0.35;
  }
}

.confetti-layer {
  position: fixed;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
  z-index: 60;
}

.confetti-piece {
  position: absolute;
  width: 8px;
  height: 14px;
  border-radius: 2px;
  background: var(--confetti-color, #ffd166);
  opacity: 0;
  transform: translate3d(0, -24px, 0) rotate(0deg);
  animation: confettiFall var(--confetti-duration, 1500ms) ease-in forwards;
  animation-delay: var(--confetti-delay, 0ms);
}

.confetti-layer.jackpot .confetti-piece {
  width: 10px;
  height: 18px;
}

@keyframes confettiFall {
  0% {
    opacity: 0;
    transform: translate3d(0, -28px, 0) rotate(0deg);
  }
  12% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translate3d(var(--confetti-x, 0px), 115vh, 0) rotate(var(--confetti-rotate, 240deg));
  }
}

.transfer-panel,
.history-panel {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 14px;
}

.transfer-panel {
  position: relative;
  overflow: hidden;
}

.transfer-panel.transfer-impact::after {
  content: '';
  position: absolute;
  inset: -20%;
  pointer-events: none;
  background: radial-gradient(circle, #54b4ff40 0%, transparent 60%);
  animation: transferShock 0.52s ease;
}

.transfer-panel.transfer-critical::before {
  content: '';
  position: absolute;
  inset: -22%;
  pointer-events: none;
  background: radial-gradient(circle, #ffcf6948 0%, transparent 62%);
  animation: transferCriticalPulse 0.66s ease;
}

.transfer-panel.transfer-swap-flip .transfer-select-btn {
  animation: transferSwapFlip 0.4s ease;
}

.transfer-panel h3,
.history-panel h3 {
  margin: 0 0 10px;
}

.transfer-controls {
  display: grid;
  gap: 10px;
}

#transferValueLabel {
  margin: 2px 0 0;
  font-size: clamp(1.1rem, 3.8vw, 1.42rem);
  font-weight: 800;
  color: #e9f4ff;
  letter-spacing: 0.01em;
}

.transfer-field {
  display: grid;
  gap: 6px;
}

.transfer-field > span {
  color: var(--muted);
  font-size: 0.92rem;
}

.transfer-select {
  position: relative;
}

.transfer-select-btn {
  width: 100%;
  min-height: 46px;
  border: 1px solid var(--border);
  border-radius: 12px;
  background: var(--panel-soft);
  color: var(--text);
  padding: 10px 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  text-align: left;
}

.transfer-select-btn.is-open {
  border-color: #4d82c2;
  box-shadow: 0 0 0 2px #4d82c23d;
}

.transfer-source-hit {
  animation: transferSourcePulse 0.42s ease;
}

.transfer-target-hit {
  animation: transferTargetPulse 0.52s ease;
}

.transfer-select-value {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  min-width: 0;
}

.transfer-select-arrow {
  color: var(--muted);
  font-size: 0.84rem;
}

.transfer-select-menu {
  position: absolute;
  left: 0;
  right: 0;
  top: calc(100% + 6px);
  display: grid;
  gap: 6px;
  padding: 8px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: #0d1b32;
  box-shadow: var(--shadow);
  z-index: 12;
  opacity: 0;
  transform: translateY(-4px);
  pointer-events: none;
  transition: opacity 0.16s ease, transform 0.16s ease;
}

.transfer-select-menu.is-open {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

.transfer-option {
  width: 100%;
  min-height: 42px;
  border: 1px solid #2e4a73;
  border-radius: 10px;
  background: #132543;
  color: var(--text);
  padding: 8px 10px;
  display: flex;
  align-items: center;
  gap: 8px;
  text-align: left;
}

.transfer-option.will-swap {
  border-style: dashed;
  border-color: #70a6e5;
  background: linear-gradient(180deg, #173158, #132543);
}

.transfer-fx-chip {
  position: fixed;
  z-index: 65;
  transform: translate(-50%, -50%);
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid #7ac5ff;
  color: #e9f6ff;
  background: linear-gradient(180deg, #1d4f7d, #123255);
  box-shadow:
    0 10px 18px #04112799,
    0 0 16px #6ac2ff66;
  font-size: 0.9rem;
  font-weight: 800;
  letter-spacing: 0.02em;
  pointer-events: none;
}

.transfer-fx-chip.critical {
  border-color: #ffd786;
  background: linear-gradient(180deg, #745116, #51350c);
  color: #ffefcc;
  box-shadow:
    0 10px 18px #1a120699,
    0 0 18px #ffd37a8a;
}

.player-color-dot {
  width: 12px;
  height: 12px;
  border-radius: 999px;
  background: var(--dot-color, #ffffff);
  box-shadow: 0 0 0 2px #ffffff30;
  flex: 0 0 auto;
}

select,
input[type='text'],
input[type='number'] {
  width: 100%;
  border: 1px solid var(--border);
  border-radius: 12px;
  background: var(--panel-soft);
  color: var(--text);
  padding: 10px 12px;
}

.primary-btn,
.secondary-btn,
.ghost-btn {
  min-height: 44px;
  border-radius: 12px;
  font-weight: 700;
  border: 1px solid var(--border);
}

.primary-btn {
  background: linear-gradient(180deg, #1f8d82, #115f59);
  color: #fff;
  border: none;
}

.primary-btn.danger {
  background: linear-gradient(180deg, #ef4444, #bf2331);
}

.secondary-btn {
  background: #203050;
  color: var(--text);
}

.ghost-btn {
  background: transparent;
  color: var(--muted);
}

.history-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 8px;
}

#historyList {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 8px;
  max-height: 230px;
  overflow: auto;
}

#historyList li {
  background: #0f1b33;
  border: 1px solid #243b5d;
  border-radius: 12px;
  padding: 9px 10px;
  display: grid;
  gap: 4px;
}

#historyList li span {
  color: var(--muted);
  font-size: 0.84rem;
}

.history-enter.history-receber {
  animation: historyEnterReceive 0.36s cubic-bezier(0.2, 0.8, 0.2, 1);
}

.history-enter.history-pagar {
  animation: historyEnterPay 0.36s cubic-bezier(0.2, 0.8, 0.2, 1);
}

.history-enter.history-transferencia {
  animation: historyEnterTransfer 0.36s cubic-bezier(0.2, 0.8, 0.2, 1);
}

.leader-change-banner {
  position: fixed;
  left: 50%;
  top: 14px;
  transform: translateX(-50%) translateY(-12px);
  z-index: 70;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 999px;
  border: 1px solid #f6cf67;
  background: linear-gradient(180deg, #2f2409, #1c2a42);
  color: #f8e6b0;
  font-weight: 800;
  opacity: 0;
  transition: transform 0.22s ease, opacity 0.22s ease;
}

.leader-change-banner.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

.leader-change-crown {
  filter: drop-shadow(0 0 10px #ffd56b);
}

.history-receber {
  background: linear-gradient(180deg, #10273a, #0f1b33);
  border-color: #2c5f78 !important;
}

.history-pagar {
  background: linear-gradient(180deg, #2b1824, #1f1627);
  border-color: #6b3350 !important;
}

.history-transferencia {
  background: linear-gradient(180deg, #1a2340, #141e39);
  border-color: #3d5386 !important;
}

.history-empty {
  color: var(--muted);
  text-align: center;
}

.modal {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(3, 7, 14, 0.72);
  padding: 18px;
  z-index: 20;
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transition:
    opacity 0.22s ease,
    visibility 0s linear 0.22s;
}

.modal.is-open {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  transition:
    opacity 0.22s ease,
    visibility 0s linear 0s;
}

.modal-card {
  width: min(620px, 100%);
  background: #0d1a31;
  border: 1px solid var(--border);
  border-radius: 18px;
  box-shadow: var(--shadow);
  padding: 18px;
  opacity: 0;
  transform: translateY(14px) scale(0.98);
  transition:
    transform 0.22s cubic-bezier(0.2, 0.8, 0.2, 1),
    opacity 0.22s ease;
}

.modal.is-open .modal-card {
  opacity: 1;
  transform: translateY(0) scale(1);
}

.setup-card {
  display: grid;
  gap: 12px;
}

.settings-card {
  display: grid;
  gap: 12px;
}

.settings-card p {
  margin: 0;
  color: var(--muted);
}

.settings-top-actions {
  display: grid;
}

.settings-players-list {
  display: grid;
  gap: 8px;
  max-height: 42vh;
  overflow: auto;
  padding-right: 2px;
}

.settings-player-row {
  display: grid;
  grid-template-columns: minmax(140px, 1fr) 72px 74px 92px;
  gap: 8px;
}

.settings-avatar-btn {
  min-height: 44px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: #203050;
  color: #fff;
  font-size: 1.3rem;
  line-height: 1;
}

.settings-actions {
  display: grid;
  gap: 8px;
}

.summary-card {
  display: grid;
  gap: 12px;
  width: min(720px, 100%);
  overflow: hidden;
  position: relative;
  max-height: min(92vh, 860px);
  overflow-y: auto;
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
  padding-bottom: 14px;
}

.summary-card p {
  margin: 0;
  color: var(--muted);
}

.summary-modal {
  background: rgba(2, 7, 15, 0.84);
}

.summary-modal.is-open .summary-card > * {
  animation: summaryItemIn 0.42s cubic-bezier(0.2, 0.8, 0.2, 1) both;
}

.summary-modal.is-open .summary-card > *:nth-child(1) {
  animation-delay: 0ms;
}
.summary-modal.is-open .summary-card > *:nth-child(2) {
  animation-delay: 45ms;
}
.summary-modal.is-open .summary-card > *:nth-child(3) {
  animation-delay: 90ms;
}
.summary-modal.is-open .summary-card > *:nth-child(4) {
  animation-delay: 130ms;
}
.summary-modal.is-open .summary-card > *:nth-child(5) {
  animation-delay: 170ms;
}
.summary-modal.is-open .summary-card > *:nth-child(6) {
  animation-delay: 210ms;
}
.summary-modal.is-open .summary-card > *:nth-child(7) {
  animation-delay: 240ms;
}

.summary-podium {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 8px;
  align-items: end;
}

.podium-card {
  border-radius: 12px;
  border: 1px solid color-mix(in oklab, var(--podium-color), #ffffff 25%);
  background: linear-gradient(
    160deg,
    color-mix(in oklab, var(--podium-color), #0f1730 72%),
    color-mix(in oklab, var(--podium-color), #091127 84%)
  );
  padding: 10px;
  display: grid;
  gap: 6px;
  align-content: start;
  box-shadow: 0 8px 20px #00000055;
  opacity: 0;
  transform: translateY(10px);
  animation: podiumDrop 0.62s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
  position: relative;
}

.podium-card::after {
  content: '';
  position: absolute;
  left: 18%;
  right: 18%;
  bottom: -8px;
  height: 10px;
  border-radius: 999px;
  background: radial-gradient(circle, #ffd7786a 0%, transparent 70%);
  opacity: 0;
  animation: podiumDust 0.6s ease;
}

.podium-card.place-1 {
  min-height: 152px;
  box-shadow:
    0 10px 26px #00000066,
    0 0 20px #ffd65d47;
}

.podium-card.place-2 {
  min-height: 128px;
}

.podium-card.place-3 {
  min-height: 116px;
}

.podium-title {
  color: #f4e7b7;
  font-weight: 800;
}

.podium-player {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-weight: 700;
}

.podium-balance {
  font-size: 1.1rem;
}

.summary-leader-gap {
  min-height: 22px;
}

.summary-gap-text {
  color: #f4de98;
  font-weight: 700;
}

.summary-list {
  display: grid;
  gap: 8px;
}

.summary-row {
  display: grid;
  grid-template-columns: 52px 28px minmax(120px, 1fr) auto 36px;
  align-items: center;
  gap: 10px;
  border: 1px solid #2a4268;
  border-radius: 12px;
  padding: 10px 12px;
  background: #0f1d36;
  opacity: 0;
  transform: translateY(8px);
  animation: rowIn 0.4s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
}

.summary-row.leader {
  border-color: #f5c04f;
  background: linear-gradient(160deg, #2a1f06, #1a2a48);
  box-shadow: 0 0 24px #f5c04b38;
}

.summary-rank {
  color: var(--muted);
  font-weight: 700;
}

.summary-move-indicator {
  font-weight: 900;
  font-size: 1rem;
  text-align: center;
}

.summary-move-indicator.up {
  color: #58ef98;
}

.summary-move-indicator.down {
  color: #ff8e95;
}

.summary-move-indicator.steady {
  color: #95aacd;
}

.summary-row.move-up {
  animation-name: rowIn, rowMoveUp;
  animation-duration: 0.4s, 0.46s;
  animation-delay: 0ms, 120ms;
  animation-fill-mode: forwards, forwards;
  animation-iteration-count: 1, 1;
  animation-timing-function: cubic-bezier(0.2, 0.8, 0.2, 1), ease-out;
}

.summary-row.move-down {
  animation-name: rowIn, rowMoveDown;
  animation-duration: 0.4s, 0.46s;
  animation-delay: 0ms, 120ms;
  animation-fill-mode: forwards, forwards;
  animation-iteration-count: 1, 1;
  animation-timing-function: cubic-bezier(0.2, 0.8, 0.2, 1), ease-out;
}

.summary-player {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-weight: 700;
}

.summary-avatar {
  font-size: 1rem;
}

.summary-balance {
  font-size: 1.05rem;
}

.summary-crown {
  font-size: 1.2rem;
  filter: drop-shadow(0 0 8px #ffd451);
  animation: crownGlow 1.4s ease-in-out infinite, crownFloat 2.6s ease-in-out infinite;
}

.summary-crown-wrap {
  position: relative;
  display: inline-flex;
  justify-content: center;
  align-items: center;
}

.summary-crown-spark {
  position: absolute;
  width: 5px;
  height: 5px;
  border-radius: 999px;
  background: #ffe385;
  box-shadow: 0 0 10px #ffe78f;
  opacity: 0;
  animation: crownSpark 1.2s ease-in-out infinite;
}

.summary-crown-spark:nth-child(2) {
  transform: translate(-13px, -10px);
}

.summary-crown-spark:nth-child(3) {
  transform: translate(14px, -8px);
}

.summary-crown-spark:nth-child(4) {
  transform: translate(0px, 12px);
}

.summary-chart {
  display: grid;
  gap: 8px;
  margin-top: 2px;
}

.summary-bar-row {
  display: grid;
  grid-template-columns: 90px 1fr;
  gap: 8px;
  align-items: center;
}

.summary-bar-label {
  color: var(--muted);
  font-size: 0.88rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.summary-bar-track {
  position: relative;
  height: 14px;
  border-radius: 999px;
  background: #0c172b;
  border: 1px solid #2a4163;
  overflow: hidden;
}

.summary-bar-fill {
  position: absolute;
  inset: 0 auto 0 0;
  width: var(--bar-size, 0%);
  border-radius: inherit;
  background: linear-gradient(90deg, color-mix(in oklab, var(--bar-color), #ffffff 18%), var(--bar-color));
  box-shadow: 0 0 16px color-mix(in oklab, var(--bar-color), #ffffff 25%);
  transform-origin: left center;
  animation: barGrow 0.55s cubic-bezier(0.2, 0.8, 0.2, 1) both;
}

.summary-bar-fill.leader {
  box-shadow:
    0 0 12px #ffd45580,
    0 0 20px #ffd45555;
}

.summary-bar-fill.leader::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  width: 26px;
  right: -10px;
  background: linear-gradient(90deg, transparent, #ffffffad, transparent);
  filter: blur(1px);
  animation: barSpark 1.2s ease-in-out infinite;
}

.summary-empty {
  color: var(--muted);
  text-align: center;
}

@keyframes crownGlow {
  0%,
  100% {
    transform: translateY(0);
    filter: drop-shadow(0 0 8px #ffd451);
  }
  50% {
    transform: translateY(-1px);
    filter: drop-shadow(0 0 14px #ffe37a);
  }
}

@keyframes crownFloat {
  0%,
  100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-2px);
  }
}

@keyframes crownSpark {
  0%,
  100% {
    opacity: 0;
    transform: scale(0.6);
  }
  40% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes barGrow {
  0% {
    transform: scaleX(0.1);
    opacity: 0.5;
  }
  100% {
    transform: scaleX(1);
    opacity: 1;
  }
}

@keyframes barSpark {
  0%,
  100% {
    opacity: 0.1;
    transform: translateX(-14px);
  }
  50% {
    opacity: 0.9;
    transform: translateX(6px);
  }
}

@keyframes rowIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes rowMoveUp {
  0% {
    transform: translateY(6px);
  }
  100% {
    transform: translateY(0);
  }
}

@keyframes rowMoveDown {
  0% {
    transform: translateY(-6px);
  }
  100% {
    transform: translateY(0);
  }
}

@keyframes podiumDrop {
  0% {
    opacity: 0;
    transform: translateY(-22px) scale(0.96);
  }
  70% {
    opacity: 1;
    transform: translateY(4px) scale(1.01);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes podiumDust {
  0% {
    opacity: 0;
    transform: scale(0.6);
  }
  45% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(1.35);
  }
}

@keyframes podiumRise {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes summaryItemIn {
  from {
    opacity: 0;
    transform: translateY(8px) scale(0.985);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.money-particles {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 63;
}

.money-particle {
  position: absolute;
  font-size: 0.9rem;
  font-weight: 900;
  color: #ffdf83;
  text-shadow: 0 0 8px #ffd0647a;
  opacity: 0;
  animation-delay: var(--money-delay, 0ms);
}

.money-particles.receive .money-particle {
  animation: moneyRise 0.9s ease-out forwards;
}

.money-particles.pay .money-particle {
  animation: moneyDrop 0.9s ease-out forwards;
}

@keyframes moneyRise {
  0% {
    opacity: 0;
    transform: translate3d(0, 10px, 0) scale(0.85);
  }
  30% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translate3d(var(--money-x, 0px), -90px, 0) scale(1.05);
  }
}

@keyframes moneyDrop {
  0% {
    opacity: 0;
    transform: translate3d(0, -10px, 0) scale(0.85);
  }
  30% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translate3d(var(--money-x, 0px), 90px, 0) scale(1.05);
  }
}

.setup-card h2,
.confirm-card h2,
.value-card h2 {
  margin: 0;
}

.setup-card p,
.value-card p {
  margin: 0;
  color: var(--muted);
}

.setup-players {
  background: #0b152a;
  border: 1px solid #24385b;
  border-radius: 14px;
  padding: 12px;
}

.setup-players-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.setup-players-head h3 {
  margin: 0;
}

#setupPlayersList {
  display: grid;
  gap: 8px;
}

.setup-player-row {
  display: grid;
  grid-template-columns: minmax(110px, 1fr) 70px 84px;
  gap: 6px;
}

.value-card {
  max-width: 420px;
}

#valueDisplay {
  display: block;
  font-size: 2rem;
  font-weight: 800;
  margin: 8px 0 14px;
}

.numpad {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}

.numpad button {
  min-height: 56px;
  font-size: 1.3rem;
  border: 1px solid #2d476f;
  border-radius: 12px;
  background: #192947;
  color: #fff;
}

.modal-actions {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin-top: 12px;
}

.toast {
  position: fixed;
  left: 50%;
  bottom: 16px;
  transform: translateX(-50%) translateY(14px);
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid #265381;
  background: #102543;
  color: #fff;
  opacity: 0;
  transition: 0.18s ease;
  z-index: 40;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-weight: 700;
}

.toast.error {
  background: #441a24;
  border-color: #8b2f44;
}

.toast.receive {
  border-color: #2f8a66;
  background: #133f34;
}

.toast.pay {
  border-color: #8b3b4c;
  background: #3c1a26;
}

.toast.transfer {
  border-color: #3a5f99;
  background: #122a4c;
}

.toast.dice {
  border-color: #8b7733;
  background: #3b3014;
}

.toast-icon {
  font-size: 1.04rem;
}

.toast-text {
  white-space: nowrap;
}

.toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

@media (max-width: 700px) {
  .app-shell {
    padding: 12px;
  }

  .actions-grid,
  .modal-actions {
    grid-template-columns: 1fr;
  }

  .setup-player-row {
    grid-template-columns: 1fr;
  }

  .settings-player-row {
    grid-template-columns: 1fr;
  }

  .summary-row {
    grid-template-columns: 42px 24px minmax(90px, 1fr) auto 30px;
  }

  .summary-player {
    min-width: 0;
  }

  .summary-player span:last-child {
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .summary-bar-row {
    grid-template-columns: 80px 1fr;
  }

  .summary-podium {
    grid-template-columns: 1fr;
  }

  .summary-card {
    max-height: 90vh;
  }

  #historyList {
    max-height: 180px;
  }
}

@media (max-width: 520px) {
  .summary-card {
    width: 100%;
    padding: 14px 12px;
    gap: 10px;
  }

  .summary-podium {
    gap: 6px;
  }

  .podium-card {
    padding: 8px;
    gap: 4px;
  }

  .podium-card.place-1,
  .podium-card.place-2,
  .podium-card.place-3 {
    min-height: 0;
  }

  .podium-player {
    min-width: 0;
    gap: 6px;
  }

  .podium-player span:last-child {
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .summary-row {
    grid-template-columns: 36px 20px minmax(0, 1fr) auto 24px;
    gap: 8px;
    padding: 8px 10px;
  }

  .summary-rank {
    font-size: 0.9rem;
  }

  .summary-move-indicator {
    font-size: 0.9rem;
  }

  .summary-balance {
    font-size: 0.95rem;
    white-space: nowrap;
  }

  .summary-crown {
    font-size: 1rem;
  }
}

@media (max-width: 380px) {
  .summary-row {
    grid-template-columns: 32px 18px minmax(0, 1fr) auto 20px;
    gap: 6px;
    padding: 8px;
  }

  .summary-rank {
    font-size: 0.82rem;
  }

  .summary-balance {
    font-size: 0.88rem;
  }

  .summary-gap-text {
    font-size: 0.9rem;
  }
}
